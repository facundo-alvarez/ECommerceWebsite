@page
@using ApplicationCore.ValueObjects
@using Microsoft.AspNetCore.Http
@using Web.Pages.Shared
@using Web.Utility

@model Web.Pages.Cart.IndexModel



<div class="container-lg">
    <div class="row">
        <div class="col">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb bg-light p-2 rounded-0">
                    <li class="breadcrumb-item">Home</li>
                    <li class="breadcrumb-item active">Shopping Cart</li>
                </ol>
            </nav>
        </div>    
    </div>
    <div class="row mb-5">
        <div class="col-8">
            <h2>Shopping Cart</h2>
        </div>
        <div class="col-4">
            <a asp-page="/Products/Index" asp-route-category="all"><p>Continue Shopping</p></a>
        </div>
    </div>
    <div id="cartList">

        <partial name="_CartListPartial" model="@Model.CartItems" />
        
    </div>
</div>
        


@section Scripts {

    <script>

        $(document).on('click', '.deleteButton', function() {

            var productId = $(this).attr('id');

            $.get('@Url.Page("Index","Delete")', { 'id': productId }, function(response) {
                $('#cartList').html(response);

                $.get('@Url.Page("Index","PartialCart")', { 'id': productId }, function(response) {
                    $('#cartMenu').html(response);
                });
            });
        });

    </script>


    <script>

       $(document).on('click', '.updateQuantity', function() {

           var productId = $(this).attr('id');
           var updateQ = 0;

           if ($(this).hasClass('addQuantity')) {
               updateQ = -1;
           }
           else if ($(this).hasClass('removeQuantity')) {
               updateQ = 1;
           }

           $.get('@Url.Page("Index","UpdateQuantity")', { 'id': productId, 'updateQuantity': updateQ }, function(response) {
               $('#cartList').html(response);
           });
       });

    </script>
}