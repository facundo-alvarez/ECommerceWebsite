@page
@model Web.Pages.Cart.IndexModel
@{
    decimal total = 0;
}

<div class="container-lg">
    <div class="row">
        <div class="col">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb bg-light p-2 rounded-0">
                    <li class="breadcrumb-item">Home</li>
                    <li class="breadcrumb-item active">Shopping Cart</li>
                </ol>
            </nav>
        </div>    
    </div>
    <div class="row mb-5">
        <div class="col-8">
            <h2>Shopping Cart</h2>
        </div>
        <div class="col-4">
            <a asp-page="/Products/Index" asp-route-category="all"><p>Continue Shopping</p></a>
        </div>
    </div>

    @if(Model.Items.Count == 0 || Model.Items == null)
    {
        <div class="row">
            <div class="col text-center">
                <h3>Cart is empty</h3>
            </div>
        </div>
    }
    else
    {
        <div class="row">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    @if(Model.Items != null)
                    {
                        foreach(var product in Model.Items)
                        {
                            var price = product.Product.Price;
                            var quantity = @product.Quantity;
                            var subtotal = price * quantity;
                            total += subtotal;

                            <tr>
                                <td class="align-middle">
                                    <div class="row">
                                        <div class="col-3">
                                            <img style="height: 4rem" src="@SiteConstants.ImagePath@product.Product.Image" asp-append-version="true">
                                        </div>
                                        <div class="col">
                                            <h5>@product.Product.Name</h5>
                                            <p>@product.Product.Price.ToString("C")</p>
                                        </div>
                                    </div>
                                </td>
                                <td class="align-middle">@quantity</td>
                                <td class="align-middle">
                                    <div class="row">
                                        <div class="col-8">@subtotal.ToString("C")</div>
                                        <div class="col">
                                            <form method="post">
                                                <input hidden asp-for="Id" value="@product.Product.Id">
                                                <button type="submit" class=" btn align-middle ms-5" style="font-size:1.25rem"><i class="bi bi-trash"></i></button>
                                            </form>
                                        </div>
                                    </div>                                   
                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>     
    <div class="row border-top justify-content-end">
        <div class="col-4 mt-4">
            <h4>Total: @total.ToString("C")</h4>
            <p>Taxes and shipping calculated at check out </p>
            <a class="btn btn-primary" asp-page="Summary">Check Out</a>
        </div>
    </div>
    }
</div>




